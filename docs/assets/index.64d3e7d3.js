import{w as me,S as Y,i as K,s as Q,e as a,a as g,b as d,t as D,c as y,d as o,l as H,p as J,n as j,f as S,r as he,g as W,h as ce,j as ge,k as Pe,o as Ae,m as Se,q as ne,u as De,v as se,x as xe,y as Ce,z as ae,A as ie,B as re,C as He,D as ue,E as Ne,F as Fe,G as je}from"./vendor.5311ca11.js";const Ee=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function l(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=l(n);fetch(n.href,i)}};Ee();function Ge(t,e,l="",s={}){let n={id:e,description:l,choices:s};return t.sections=t.sections||{},t.sections[e]=n,t}function Ue(t={title:"Unnamed Adventure"},e={}){return{metadata:t,sections:e}}function ze(t,e){let l=`flowchart TB

`;for(const s in t.sections){let n=t.sections[s];l+=`${n.id}
`,l+=`click ${n.id} call editSection() "Edit Section"
`,n.id==e&&(l+=`style ${n.id} stroke:#333,stroke-width:4px
`);for(const i in n.choices){let r=n.choices[i];l+=`${n.id} --${r.label}--> ${r.destination}
`}}return console.dir("book",t),console.log("diagram",l),l}function Le(t){t.metadata.title===""&&(t.metadata.title="Unnamed Adventure"),localStorage.setItem(t.metadata.title,JSON.stringify(t)),localStorage.setItem("current book",t.metadata.title)}const _e=me(""),z=me(Ue()),ve=me(""),ke=me({to:"about",data:{}}),U=(t,e={})=>{ke.set({to:t,data:e})};function Re(t){let e,l,s,n,i,r,c,p,m,f,b,v,$,x,_,h,O,C,M,I,B,T,A,E,N;return{c(){e=a("li"),l=a("a"),l.textContent="Books",s=g(),n=a("li"),i=a("a"),i.textContent="Settings",r=g(),c=a("li"),p=a("a"),p.textContent="Sections",m=g(),f=a("li"),b=a("a"),b.textContent="Save/Load",v=g(),$=a("li"),x=a("a"),x.textContent="Export",_=g(),h=a("li"),O=a("a"),O.textContent="Help",C=g(),M=a("li"),I=a("a"),I.textContent="About",B=g(),T=a("li"),A=a("a"),A.textContent="Source-Code",d(l,"href","?view=books"),D(e,"bordered",t[0].to=="books"),d(i,"href","?view=settings"),D(n,"bordered",t[0].to=="settings"),d(p,"href","?view=editor"),D(c,"bordered",t[0].to=="editor"),d(b,"href","?view=saveload"),D(f,"bordered",t[0].to=="saveload"),d(x,"href","?view=export"),D($,"bordered",t[0].to=="export"),d(O,"href","?view=help"),D(h,"bordered",t[0].to=="help"),d(I,"href","?view=about"),D(M,"bordered",t[0].to=="about"),d(A,"href","?view=sourcecode"),D(T,"bordered",t[0].to=="sourcecode")},m(u,k){y(u,e,k),o(e,l),y(u,s,k),y(u,n,k),o(n,i),y(u,r,k),y(u,c,k),o(c,p),y(u,m,k),y(u,f,k),o(f,b),y(u,v,k),y(u,$,k),o($,x),y(u,_,k),y(u,h,k),o(h,O),y(u,C,k),y(u,M,k),o(M,I),y(u,B,k),y(u,T,k),o(T,A),E||(N=[H(l,"click",J(t[1])),H(i,"click",J(t[2])),H(p,"click",J(t[3])),H(b,"click",J(t[4])),H(x,"click",J(t[5])),H(O,"click",J(t[6])),H(I,"click",J(t[7])),H(A,"click",J(t[8]))],E=!0)},p(u,[k]){k&1&&D(e,"bordered",u[0].to=="books"),k&1&&D(n,"bordered",u[0].to=="settings"),k&1&&D(c,"bordered",u[0].to=="editor"),k&1&&D(f,"bordered",u[0].to=="saveload"),k&1&&D($,"bordered",u[0].to=="export"),k&1&&D(h,"bordered",u[0].to=="help"),k&1&&D(M,"bordered",u[0].to=="about"),k&1&&D(T,"bordered",u[0].to=="sourcecode")},i:j,o:j,d(u){u&&S(e),u&&S(s),u&&S(n),u&&S(r),u&&S(c),u&&S(m),u&&S(f),u&&S(v),u&&S($),u&&S(_),u&&S(h),u&&S(C),u&&S(M),u&&S(B),u&&S(T),E=!1,he(N)}}}function qe(t,e,l){let s;return W(t,ke,v=>l(0,s=v)),[s,()=>{U("books")},()=>{U()},()=>{U("editor")},()=>{U("saveload")},()=>{U()},()=>{U()},()=>{U("about")},()=>{U()}]}class Me extends Y{constructor(e){super();K(this,e,qe,Re,Q,{})}}function Je(t){let e;return{c(){e=a("div"),e.innerHTML=`<footer class="footer items-center p-4 bg-neutral text-neutral-content"><div class="items-center grid-flow-col"><p class="hidden lg:block">Made in London with love by <a class="link link-primary" href="https://andregarzia.com">Andre Alves Garzia</a> \u2022 If you like this software, you can support me by <a class="link link-primary" target="_blank" href="https://ko-fi.com/andreshouldbewriting">buying me a coffee</a>. Seriously, I&#39;m a writer and I need coffee.</p> 
	<p class="lg:hidden"><a class="link link-primary" target="_blank" href="https://ko-fi.com/andreshouldbewriting">Buy me a Coffee.</a></p></div>  
  <div class="grid-flow-col gap-4 md:place-self-center md:justify-self-end"><a target="_blank" href="https://twitter.com/soapdog"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a></div></footer>`,d(e,"class","fixed inset-x-0 bottom-0")},m(l,s){y(l,e,s)},p:j,i:j,o:j,d(l){l&&S(e)}}}class We extends Y{constructor(e){super();K(this,e,null,Je,Q,{})}}function Ye(t){let e,l;return{c(){e=a("div"),l=ce(t[0]),d(e,"class","mermaid"),d(e,"id","chart")},m(s,n){y(s,e,n),o(e,l)},p(s,[n]){n&1&&ge(l,s[0])},i:j,o:j,d(s){s&&S(e)}}}function Ke(t,e,l){let s;W(t,_e,i=>l(0,s=i));const n=Pe();return window.editSection=i=>{console.log("callback",i),n("clickSection",i)},Ae(()=>{let i={startOnLoad:!1,flowchart:{useMaxWidth:!0,htmlLabels:!0,curve:"cardinal"},securityLevel:"loose"};console.log("initial diagram data:",s),Se.initialize(i),_e.subscribe(r=>{if(console.log("data updated",r),r==="")return console.log("passed no data to mermaid diagram."),!1;let c=document.getElementById("chart"),p=function(m,f){c.innerHTML=m,f(c)};Se.render("preparedScheme",r,p,c)})}),[s]}class Qe extends Y{constructor(e){super();K(this,e,Ke,Ye,Q,{})}}function Be(t,e,l){const s=t.slice();return s[12]=e[l],s}function Ie(t){let e,l=t[2].sections[t[12]].id+"",s,n,i;return{c(){e=a("option"),s=ce(l),e.selected=n=t[1]==t[2].sections[t[12]].id,e.__value=i=t[2].sections[t[12]].id,e.value=e.__value},m(r,c){y(r,e,c),o(e,s)},p(r,c){c&4&&l!==(l=r[2].sections[r[12]].id+"")&&ge(s,l),c&6&&n!==(n=r[1]==r[2].sections[r[12]].id)&&(e.selected=n),c&4&&i!==(i=r[2].sections[r[12]].id)&&(e.__value=i,e.value=e.__value)},d(r){r&&S(e)}}}function Ve(t){let e,l,s,n,i,r,c,p,m,f,b,v,$,x,_,h,O,C,M,I,B,T,A,E,N,u,k,w,R,de,G,q,V,X,Z,ee,te,we,fe,pe,be,$e;n=new Qe({}),n.$on("clickSection",t[7]);let le=Object.keys(t[2].sections),F=[];for(let L=0;L<le.length;L+=1)F[L]=Ie(Be(t,le,L));return{c(){e=a("div"),l=a("div"),s=a("div"),ne(n.$$.fragment),i=g(),r=a("div"),c=a("div"),p=a("span"),p.textContent="You're editing",m=g(),f=a("div"),b=a("select"),v=a("option"),v.textContent="Select section to edit";for(let L=0;L<F.length;L+=1)F[L].c();$=g(),x=a("button"),x.textContent="New Section",_=g(),h=a("button"),h.textContent="Delete Section",O=g(),C=a("div"),M=a("label"),M.innerHTML=`<span class="label-text">Section description</span> 
					<span class="label-text-alt">Remember that the Playdate is a small device.</span>`,I=g(),B=a("textarea"),T=g(),A=a("div"),E=g(),N=a("div"),u=a("div"),u.innerHTML=`<label class="label"><span class="label-text">Choice Label</span></label> 
					<input type="text" class="input input-primary"/>`,k=g(),w=a("div"),R=a("label"),R.innerHTML='<span class="label-text">Destination</span>',de=g(),G=a("select"),q=a("option"),q.textContent="Pick your favorite Simpson",V=a("option"),V.textContent="Homer",X=a("option"),X.textContent="Marge",Z=a("option"),Z.textContent="Bart",ee=a("option"),ee.textContent="Lisa",te=a("option"),te.textContent="Maggie",we=g(),fe=a("div"),fe.innerHTML=`<div class="form-control pr-2 flex-1"><label class="label"><span class="label-text">Required tags</span></label> 
					<input type="text" class="input input-primary"/></div> 
				<div class="form-control pr-2 flex-1"><label class="label"><span class="label-text">Prohibited tags</span></label> 
					<input type="text" class="input input-primary"/></div> 
				<div class="form-control pr-2 flex-1"><label class="label"><span class="label-text">New tags</span></label> 
					<input type="text" class="input input-primary"/></div>`,d(s,"class","flex-1 p-2"),d(p,"class","flex-1"),v.disabled=!0,v.__value="Select section to edit",v.value=v.__value,d(b,"class","select select-primary w-full"),t[1]===void 0&&De(()=>t[8].call(b)),d(f,"class","form-control m-2"),d(x,"class","btn btn-ghost m-2"),d(h,"class","btn btn-ghost m-2"),d(c,"class","flex items-center"),d(M,"class","label"),d(B,"class","textarea textarea-bordered textarea-primary h-24"),d(B,"placeholder","Your masterpiece here. No instadeath please."),d(C,"class","form-control"),d(A,"class","divider"),d(u,"class","form-control pr-2 flex-1"),d(R,"class","label"),q.disabled=!0,q.selected=!0,q.__value="Pick your favorite Simpson",q.value=q.__value,V.__value="Homer",V.value=V.__value,X.__value="Marge",X.value=X.__value,Z.__value="Bart",Z.value=Z.__value,ee.__value="Lisa",ee.value=ee.__value,te.__value="Maggie",te.value=te.__value,d(G,"class","select select-primary w-full"),d(w,"class","form-control pr-2 flex-1"),d(N,"class","flex"),d(fe,"class","flex"),d(r,"class","flex-1"),d(l,"class","flex"),d(e,"class","p-5")},m(L,oe){y(L,e,oe),o(e,l),o(l,s),se(n,s,null),o(l,i),o(l,r),o(r,c),o(c,p),o(c,m),o(c,f),o(f,b),o(b,v);for(let P=0;P<F.length;P+=1)F[P].m(b,null);xe(b,t[1]),o(c,$),o(c,x),o(c,_),o(c,h),o(r,O),o(r,C),o(C,M),o(C,I),o(C,B),Ce(B,t[0]),o(r,T),o(r,A),o(r,E),o(r,N),o(N,u),o(N,k),o(N,w),o(w,R),o(w,de),o(w,G),o(G,q),o(G,V),o(G,X),o(G,Z),o(G,ee),o(G,te),o(r,we),o(r,fe),pe=!0,be||($e=[H(b,"change",t[8]),H(b,"change",t[9]),H(x,"click",t[3]),H(h,"click",t[5]),H(B,"input",t[10]),H(B,"change",t[6])],be=!0)},p(L,[oe]){if(oe&6){le=Object.keys(L[2].sections);let P;for(P=0;P<le.length;P+=1){const ye=Be(L,le,P);F[P]?F[P].p(ye,oe):(F[P]=Ie(ye),F[P].c(),F[P].m(b,null))}for(;P<F.length;P+=1)F[P].d(1);F.length=le.length}oe&6&&xe(b,L[1]),oe&1&&Ce(B,L[0])},i(L){pe||(ae(n.$$.fragment,L),pe=!0)},o(L){ie(n.$$.fragment,L),pe=!1},d(L){L&&S(e),re(n),He(F,L),be=!1,he($e)}}}function Xe(t,e,l){let s,n;W(t,ve,_=>l(1,s=_)),W(t,z,_=>l(2,n=_));let i="";Ae(()=>{f()});const r=()=>{let _=prompt("ID for the new section (keep it short)");_=_.replace(/[^\u00BF-\u1FFF\u2C00-\uD7FF\w]+|[\_]+/ig,"-"),_=="end"&&(_="'end'"),z.set(Ge(n,_)),c(_)},c=_=>{ue(ve,s=_,s),l(0,i=n.sections[s].description),f()},p=()=>{let _=s;if(confirm(`Are you sure you want to delete section: "${_}"? This cannot be undone.`)){let O=n.sections;delete O[_],ue(z,n.sections=O,n),Le(n);let C=Object.keys(n.sections);c(C[0]),f()}},m=()=>{ue(z,n.sections[s].description=i,n),Le(n)},f=()=>{_e.set(ze(n,s))},b=_=>{console.log("handleClickSection",_),c(_.detail)};function v(){s=Ne(this),ve.set(s)}const $=()=>{c(s)};function x(){i=this.value,l(0,i)}return[i,s,n,r,c,p,m,b,v,$,x]}class Ze extends Y{constructor(e){super();K(this,e,Xe,Ve,Q,{})}}function et(t){let e;return{c(){e=a("div"),e.innerHTML='<article class="prose"><h1>About Gamebook Webby Press</h1></article>',d(e,"class","p-4")},m(l,s){y(l,e,s)},p:j,i:j,o:j,d(l){l&&S(e)}}}class tt extends Y{constructor(e){super();K(this,e,null,et,Q,{})}}function lt(t){let e,l,s,n,i,r,c,p,m,f=t[0].metadata.title+"",b,v,$,x,_,h,O,C,M,I,B;return{c(){e=a("div"),l=a("article"),s=a("h2"),s.textContent="Save & Load",n=g(),i=a("p"),i.innerHTML="Use the buttons below to save or load your current gamebook to disk. Remember that <i>Gamebook.Webby.Press</i> always save your gamebook to your browser storage as well.",r=g(),c=a("p"),p=ce("You are currently editing "),m=a("b"),b=ce(f),v=ce(" gamebook."),$=g(),x=a("button"),x.textContent="Save To Disk",_=g(),h=a("br"),O=a("br"),C=g(),M=a("button"),M.textContent="Load From Disk",d(x,"class","btn btn-primary"),d(M,"class","btn btn-primary"),d(l,"class","prose"),d(e,"class","p-4")},m(T,A){y(T,e,A),o(e,l),o(l,s),o(l,n),o(l,i),o(l,r),o(l,c),o(c,p),o(c,m),o(m,b),o(c,v),o(l,$),o(l,x),o(l,_),o(l,h),o(l,O),o(l,C),o(l,M),I||(B=[H(x,"click",t[1]),H(M,"click",t[1])],I=!0)},p(T,[A]){A&1&&f!==(f=T[0].metadata.title+"")&&ge(b,f)},i:j,o:j,d(T){T&&S(e),I=!1,he(B)}}}function ot(t,e,l){let s;return W(t,z,i=>l(0,s=i)),[s,()=>{let i=JSON.stringify(s),r=new Blob([i],{type:"text/json;charset=utf-8"}),c=URL.createObjectURL(r),p=document.createElement("a");p.download=s.metadata.title+".json",p.href=c,p.click()}]}class nt extends Y{constructor(e){super();K(this,e,ot,lt,Q,{})}}function Oe(t,e,l){const s=t.slice();return s[4]=e[l],s}function Te(t){let e,l,s=t[4].metadata.title+"",n,i,r,c;function p(){return t[2](t[4])}return{c(){e=a("li"),l=a("button"),n=ce(s),i=g(),d(l,"class","btn btn-ghost")},m(m,f){y(m,e,f),o(e,l),o(l,n),o(e,i),r||(c=H(l,"click",p),r=!0)},p(m,f){t=m},d(m){m&&S(e),r=!1,c()}}}function st(t){let e,l,s,n,i,r,c,p=t[0],m=[];for(let f=0;f<p.length;f+=1)m[f]=Te(Oe(t,p,f));return{c(){e=a("div"),l=a("article"),s=a("h2"),s.textContent="Books",n=g(),i=a("p"),i.innerHTML="<i>Gamebook.Webby.Press</i> always save your gamebooks to your browser local storage. Click on a book below to load them.",r=g(),c=a("ul");for(let f=0;f<m.length;f+=1)m[f].c();d(l,"class","prose"),d(e,"class","p-4")},m(f,b){y(f,e,b),o(e,l),o(l,s),o(l,n),o(l,i),o(l,r),o(l,c);for(let v=0;v<m.length;v+=1)m[v].m(c,null)},p(f,[b]){if(b&3){p=f[0];let v;for(v=0;v<p.length;v+=1){const $=Oe(f,p,v);m[v]?m[v].p($,b):(m[v]=Te($),m[v].c(),m[v].m(c,null))}for(;v<m.length;v+=1)m[v].d(1);m.length=p.length}},i:j,o:j,d(f){f&&S(e),He(m,f)}}}function at(t,e,l){var c;let s;W(t,z,p=>l(3,s=p));let n=[];for(let p=0;p<=localStorage.length;p++){let m=localStorage.key(p),f=localStorage.getItem(m);try{let b=JSON.parse(f);((c=b==null?void 0:b.metadata)==null?void 0:c.title)&&n.push(b)}catch{}}const i=p=>{let m=localStorage.getItem(p),f=JSON.parse(m);ue(z,s=f,s),U("editor")};return[n,i,p=>{i(p.metadata.title)}]}class it extends Y{constructor(e){super();K(this,e,at,st,Q,{})}}function rt(t){let e,l,s,n,i,r,c,p,m,f,b,v,$,x,_,h,O,C,M,I,B,T,A,E,N;$=new Me({});var u=t[1][t[0].to];function k(w){return{props:{data:w[0].data}}}return u&&(h=new u(k(t))),C=new We({}),E=new Me({}),{c(){e=a("main"),l=a("div"),s=a("input"),n=g(),i=a("div"),r=a("div"),c=a("div"),c.innerHTML='<label for="my-drawer-3" class="btn btn-square btn-ghost"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-6 h-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></label>',p=g(),m=a("div"),m.textContent="Gamebook.Webby.Press",f=g(),b=a("div"),v=a("ul"),ne($.$$.fragment),x=g(),_=a("div"),h&&ne(h.$$.fragment),O=g(),ne(C.$$.fragment),M=g(),I=a("div"),B=a("label"),T=g(),A=a("ul"),ne(E.$$.fragment),d(s,"id","my-drawer-3"),d(s,"type","checkbox"),d(s,"class","drawer-toggle"),d(c,"class","flex-none lg:hidden"),d(m,"class","flex-1 px-2 mx-2 font-semibold"),d(v,"class","menu menu-horizontal"),d(b,"class","flex-none hidden lg:block"),d(r,"class","w-full navbar bg-base-300"),d(_,"class","flex flex-col"),d(i,"class","drawer-content flex flex-col"),d(B,"for","my-drawer-3"),d(B,"class","drawer-overlay"),d(A,"class","menu p-4 overflow-y-auto w-80 bg-base-100"),d(I,"class","drawer-side"),d(l,"class","drawer h-screen w-full")},m(w,R){y(w,e,R),o(e,l),o(l,s),o(l,n),o(l,i),o(i,r),o(r,c),o(r,p),o(r,m),o(r,f),o(r,b),o(b,v),se($,v,null),o(i,x),o(i,_),h&&se(h,_,null),o(_,O),se(C,_,null),o(l,M),o(l,I),o(I,B),o(I,T),o(I,A),se(E,A,null),N=!0},p(w,[R]){const de={};if(R&1&&(de.data=w[0].data),u!==(u=w[1][w[0].to])){if(h){je();const G=h;ie(G.$$.fragment,1,0,()=>{re(G,1)}),Fe()}u?(h=new u(k(w)),ne(h.$$.fragment),ae(h.$$.fragment,1),se(h,_,O)):h=null}else u&&h.$set(de)},i(w){N||(ae($.$$.fragment,w),h&&ae(h.$$.fragment,w),ae(C.$$.fragment,w),ae(E.$$.fragment,w),N=!0)},o(w){ie($.$$.fragment,w),h&&ie(h.$$.fragment,w),ie(C.$$.fragment,w),ie(E.$$.fragment,w),N=!1},d(w){w&&S(e),re($),h&&re(h),re(C),re(E)}}}function ct(t,e,l){let s,n;W(t,z,p=>l(2,s=p)),W(t,ke,p=>l(0,n=p));let i=location.search,r=new URLSearchParams(i);if(r.get("view")&&U(r.get("view")),localStorage.getItem("current book")){let p=localStorage.getItem("current book"),m=localStorage.getItem(p),f=JSON.parse(m);ue(z,s=f,s),U("editor")}return[n,{about:tt,editor:Ze,saveload:nt,books:it}]}class dt extends Y{constructor(e){super();K(this,e,ct,rt,Q,{})}}new dt({target:document.getElementById("app")});
